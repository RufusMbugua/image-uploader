jQuery.fn.extend({imageUpload:function(path,options){$(".actual-image").hide();var oFReader=new FileReader;oFReader.readAsDataURL($('input[type="file"].image-file').files[0]),oFReader.onload=function(oFREvent){document.getElementById("imagePreview").src=oFREvent.target.result,$(".image-preview").show(),$(".image-preview").attr("data-cropped","false"),$(".image-preview").cropper("destroy"),$(".image-preview").cropper(options),$("a.crop-image-btn").show(),$("a.crop-image-btn").on("click",function(e){canvas=$(".image-preview").cropper("getCroppedCanvas"),canvas.toBlob(function(blob){var data=new FormData,post_url=path+"/updateAvatar";data.append(user,blob),$.ajax({url:post_url,data:data,cache:!1,contentType:!1,processData:!1,type:"POST",success:function(data){data.success?($(".image-preview").cropper("destroy"),$(".image-preview").hide(),$(".actual-image").show(),$(".crop-image-btn").hide(),$(".actual-image").attr("src",data.URL_TO_UPLOADED_IMAGE)):alert(data.ERROR_MESSAGE)},error:function(){alert(CUSTOM_ERROR_MESSAGE)}})},"image/jpeg")})}}});